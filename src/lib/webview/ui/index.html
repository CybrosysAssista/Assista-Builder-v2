<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src {{cspSource}} 'unsafe-inline'; script-src 'nonce-{{nonce}}';">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assista X</title>
  <meta id="historyAssets" data-css="{{historyCssUri}}" data-js="{{historyJsUri}}">
  <link rel="stylesheet" href="{{historyCssUri}}">
  <link rel="stylesheet" href="{{mainCssUri}}">
</head>
<body>
  <div class="main-content">
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen" aria-hidden="true" style="display:none">
      <div class="welcome-container">
        <div class="welcome-header">
          <div class="logo-container">
            <svg class="logo-icon" viewBox="0 0 24 24" width="48" height="48" fill="currentColor" aria-hidden="true">
              <path d="M12 2l2.39 4.84L20 8.27l-3.9 3.8.92 5.37L12 15.9l-4.98 2.62.92-5.37L4 8.27l5.61-1.43L12 2z"/>
            </svg>
          </div>
          <h1 class="welcome-title">Assista X</h1>
          <p class="welcome-subtitle">Your AI-powered development assistant for Odoo</p>
        </div>
        
        <div class="welcome-actions">
          <button class="action-card" id="wsNewProjectBtn" type="button">
            <div class="action-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                <path d="M19 3H5a2 2 0 0 0-2 2v3h2V5h14v14h-3v2h3a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/>
                <path d="M3 21h10a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2zm1-9h8v2H4v-2zm0 4h8v2H4v-2z"/>
              </svg>
            </div>
            <span class="action-label">Generate New Project</span>
            <span class="action-description">Create a new Odoo module from scratch</span>
          </button>
          
          <button class="action-card" id="wsEditProjectBtn" type="button">
            <div class="action-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/>
                <path d="M20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/>
              </svg>
            </div>
            <span class="action-label">Edit Existing Project</span>
            <span class="action-description">Modify and enhance your current module</span>
          </button>
        </div>
        
        <div class="welcome-tips">
          <div class="tip-item">
            <span class="tip-icon">ðŸ“Ž</span>
            <span class="tip-text">Type <kbd>#</kbd> to attach context</span>
          </div>
          <div class="tip-item">
            <span class="tip-icon">@</span>
            <span class="tip-text">Chat with extensions</span>
          </div>
          <div class="tip-item">
            <span class="tip-icon">/</span>
            <span class="tip-text">Use commands</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Messages Container -->
    <div class="messages" id="messages"></div>
    
    <!-- Progress Panel -->
    <div class="progress-panel" id="progressPanel">
      <div class="progress-content">
        <div class="progress-spinner"></div>
        <div class="progress-text" id="progressText">Preparingâ€¦</div>
      </div>
      <button class="btn btn-secondary btn-sm" id="progressCancelBtn" style="display:none">Cancel</button>
    </div>
    
    <!-- History Overlay -->
    <div class="overlay history-overlay" id="historyOverlay" aria-hidden="true">
      <div id="historyRoot"></div>
    </div>
    
    <!-- Settings Overlay -->
    <div class="overlay settings-overlay" id="settingsOverlay">
      <div class="modal-card">
        <div class="modal-header">
          <h2 class="modal-title">Settings</h2>
          <button class="btn-icon" id="closeSettingsBtn" aria-label="Close">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-field">
            <label class="form-label">Provider</label>
            <div id="providerTabs" class="provider-tabs"></div>
          </div>
          <div class="form-field">
            <label for="apiKey" class="form-label">API Key</label>
            <input type="password" id="apiKey" class="form-input" placeholder="Enter API Key" />
          </div>
          <div class="form-field">
            <label for="model" class="form-label">Model</label>
            <input type="text" id="model" class="form-input" placeholder="e.g., gpt-4o" list="models-datalist" />
            <datalist id="models-datalist"></datalist>
          </div>
          <div class="form-field" id="customUrlField">
            <label for="customUrl" class="form-label">Custom URL</label>
            <input type="text" id="customUrl" class="form-input" placeholder="https://api.example.com/v1" />
          </div>
          <div id="saveStatus" class="form-status"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancelSettingsBtn">Cancel</button>
          <button class="btn btn-primary" id="saveSettingsBtn">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Bar -->
  <div class="confirm-bar" id="confirmBar" aria-hidden="true">
    <div class="confirm-content">
      <div class="confirm-label" id="confirmLabel">Proceed with the planned changes?</div>
      <div class="confirm-actions">
        <button class="btn btn-primary" id="proceedBtn" type="button">Proceed</button>
        <button class="btn btn-secondary" id="cancelBtn" type="button">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Input Panel -->
  <div class="input-panel">
    <div class="input-container">
      <div class="input-wrapper">
        <div id="highlightLayer" class="highlight-layer" aria-hidden="true"></div>
        <textarea id="chatInput" class="chat-input" placeholder="Ask anything (Ctrl+L)" rows="2"></textarea>
        <button class="btn-icon btn-stop" id="stopBtn" title="Stop generation" aria-label="Stop generation" type="button">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <rect x="6" y="6" width="12" height="12" rx="2"/>
          </svg>
        </button>
      </div>
      <div class="input-footer">
        <div id="contextChips" class="context-chips" aria-live="polite" aria-atomic="true"></div>
        <div class="input-actions">
          <button class="btn-icon" id="addContextBtn" title="Add Context" type="button" aria-label="Add Context">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14M5 12h14"/>
            </svg>
          </button>
          <button class="btn-icon btn-send" id="sendBtn" title="Send (Enter)" type="button" aria-label="Send">
            <svg viewBox="0 0 20 20" fill="none" aria-hidden="true">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <script nonce="{{nonce}}" src="{{historyJsUri}}"></script>
  <script nonce="{{nonce}}" src="{{mainJsUri}}"></script>
</body>
</html>


